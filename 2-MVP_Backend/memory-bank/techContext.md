# Technical Context: NLP-Atomic-Backend

## Technologies Used

### Core Backend
- **Python 3.9+:** The primary programming language for the service.
- **Flask (or FastAPI):** Web framework for building the API. Flask is simpler for synchronous tasks; FastAPI would be considered if extensive async operations become necessary in future versions. For V1, Flask is likely sufficient.
- **OpenAI Python SDK (`openai`):** Official library for interacting with OpenAI's ChatCompletion API (e.g., GPT-4 with function calling).
- **Atomic Simulation Environment (`ase`):** Python library for building, manipulating, and saving atomic structures. Used by the `Structure Executor` to generate PDB/XYZ data.
- **Pydantic:** Data validation library used to define and enforce schemas for commands generated by the LLM and for API request/response models if FastAPI is chosen.

### Supporting Libraries
- **`Flask-CORS`:** If using Flask, to handle Cross-Origin Resource Sharing for requests from the frontend.
- **Python `logging` module:** For application logging. Sentry integration is optional for more advanced error tracking.
- **`pytest`:** Framework for writing and running unit and integration tests.
- **`gunicorn` or `uvicorn`:** WSGI/ASGI server for deploying the Flask/FastAPI application in a production-like environment (though not strictly part of V1 development, good to keep in mind).

## Development Setup

### Local Environment
1.  **Python Virtual Environment:** Essential for managing project dependencies.
    ```bash
    python3 -m venv venv
    source venv/bin/activate  # or venv\Scripts\activate on Windows
    ```
2.  **Dependency Installation:** Dependencies are listed in `requirements.txt`.
    ```bash
    pip install -r requirements.txt
    ```
    Initial `requirements.txt` content:
    ```
    flask
    flask-cors
    openai
    ase
    pydantic
    pytest
    ```
3.  **OpenAI API Key:** Must be configured as an environment variable.
    - Create a `.env` file in the project root (and add `.env` to `.gitignore`):
      ```
      OPENAI_API_KEY="your_openai_api_key_here"
      ```
    - Load this in `config.py` or directly access `os.getenv("OPENAI_API_KEY")`.
4.  **Running the Flask App (Development):**
    ```bash
    export FLASK_APP=app.py  # or backend.app:app if app.py is in a 'backend' subdir
    export FLASK_ENV=development # Enables debug mode
    flask run
    ```

### Project Structure (Illustrative)
```
/ (Workspace Root)
├── 2-MVP_Backend/
│   ├── app.py                 # Flask application, API endpoint
│   ├── config.py              # Configuration (e.g., API keys)
│   ├── requirements.txt       # Python dependencies
│   ├── nlp/
│   │   └── llm_client.py      # OpenAI client and prompt logic
│   ├── models/
│   │   └── commands.py        # Pydantic models for command validation
│   ├── executor/
│   │   ├── __init__.py
│   │   ├── structure.py       # ASE-based structure generation
│   │   └── view.py            # View command calculations
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── error_handlers.py  # Custom error classes and handlers
│   │   └── logging_setup.py   # Logging configuration
│   ├── tests/                 # Pytest unit and integration tests
│   │   ├── __init__.py
│   │   ├── test_api.py
│   │   ├── test_nlp_client.py
│   │   ├── test_models.py
│   │   └── test_executor.py
│   ├── docs/                  # All specification documents
│   │   ├── PLANNING.md
│   │   ├── TASK.md
│   │   ├── API_SPEC.md
│   │   ├── JSON_SCHEMA.md
│   │   ├── ARCHITECTURE.md
│   │   └── MODULE_SPEC.md
│   └── memory-bank/           # Roo's memory bank for this implementation
│       ├── projectbrief.md
│       ├── productContext.md
│       ├── systemPatterns.md
│       ├── techContext.md
│       ├── activeContext.md
│       └── progress.md
├── PLANNING.md                # Symlink to 2-MVP_Backend/docs/PLANNING.md
├── TASK.md                    # Symlink to 2-MVP_Backend/docs/TASK.md
└── memory-bank/               # Symlink to 2-MVP_Backend/memory-bank/
```

## Technical Constraints
- **Statelessness:** The API must be stateless. No data should be stored between requests on the server side.
- **Performance:** The `/api/commands` endpoint should typically respond in under 3 seconds.
- **Python 3.9+:** Ensure compatibility with this Python version.
- **Security:** Input sanitization is implicitly handled by structured command generation and Pydantic validation. Error messages should not leak internal details.

## Tool Usage Patterns
- **Git & GitHub:** For version control, branching (feature branches), pull requests, and CI (GitHub Actions).
- **Pip & Virtual Environments:** For Python package and environment management.
- **`flake8` & `black`:** For linting and code formatting, enforced via CI.
- **`pytest`:** For automated testing.
- **`curl` or Postman/Insomnia:** For manually testing the API endpoint during development.
- **Mermaid:** For diagrams in Markdown documentation.